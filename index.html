<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced HLS Player</title>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 3rem;
            background-image: linear-gradient(to bottom, #f3f4f6, #d1d5db);
            min-height: 100vh;
            overflow-x: hidden;
        }
        .container {
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 1rem;
            padding: 2.5rem;
            box-shadow: 0 6px 10px -2px rgba(0, 0, 0, 0.15), 0 3px 7px -2px rgba(0, 0, 0, 0.1);
            width: 90%;
            max-width: 800px;
            box-sizing: border-box;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            position: relative; /* Needed for absolute positioning of popup */
        }
        h1 {
            color: #1e293b;
            text-align: center;
            margin-bottom: 2rem;
            font-size: 2.5rem;
            font-weight: 700;
            letter-spacing: -0.025em;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.05);
        }
        video {
            width: 100%;
            border-radius: 0.75rem;
            margin-bottom: 2rem;
            background-color: #000;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            transition: box-shadow 0.3s ease;
        }
        video:hover {
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
        }
        .input-container {
            display: flex;
            flex-direction: column;
            margin-bottom: 1.5rem;
        }
        label {
            color: #4b5563;
            margin-bottom: 0.75rem;
            font-weight: 600;
            display: block;
            font-size: 1.1rem;
            transition: color 0.2s ease;
        }
        #hls-url {
            padding: 0.8rem 1.2rem;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            font-size: 1.05rem;
            width: calc(100% - 2.4rem);
            box-sizing: border-box;
            transition: border-color 0.2s ease-in-out, shadow-sm 0.2s ease-in-out, background-color 0.2s ease;
            background-color: #fff;
        }
        #hls-url:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.15);
            background-color: #f7fafc;
        }
        #hls-url:hover {
            background-color: #f7fafc;
        }
        #load-button {
            padding: 0.8rem 2rem;
            background-color: #3b82f6;
            color: #ffffff;
            border: none;
            border-radius: 0.5rem;
            cursor: pointer;
            display: block;
            margin: 0 auto;
            width: fit-content;
            font-size: 1.1rem;
            font-weight: 600;
            transition: background-color 0.3s ease-in-out, transform 0.15s ease-in-out, box-shadow 0.3s ease-in-out;
            box-shadow: 0 3px 7px rgba(0, 0, 0, 0.25);
            animation: pulse 2s infinite alternate;
        }
        #load-button:hover {
            background-color: #2563eb;
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.35);
        }
        #load-button:active {
            transform: translateY(0) scale(1);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
            animation: none;
        }
        @keyframes pulse {
            from { transform: scale(1); }
            to { transform: scale(1.03); }
        }
        #error-message {
            color: #dc2626;
            margin-top: 1.5rem;
            text-align: center;
            padding: 1rem 1.5rem;
            background-color: #fee2e2;
            border: 1px solid #fecaca;
            border-radius: 0.5rem;
            font-size: 1rem;
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .loading {
            display: none;
            text-align: center;
            margin-top: 1.5rem;
            font-size: 1.1rem;
            color: #6b7280;
            font-weight: 500;
            animation: spin 1s linear infinite;
        }
        .loading.show {
            display: block;
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Telegram Popup Styles */
        #telegram-popup {
            position: fixed; /* Use fixed positioning */
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(0, 0, 0, 0.8); /* Darker background */
            color: #fff;
            padding: 2rem;
            border-radius: 1rem;
            text-align: center;
            font-size: 1.2rem;
            z-index: 1000;
            display: none; /* Initially hidden */
            opacity: 0;
            transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out; /* Add transform transition */
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.6); /* Stronger shadow */
        }
        #telegram-popup.show {
            display: block;
            opacity: 1;
            transform: translate(-50%, -50%) scale(1); /* Scale up on show */
        }
        #telegram-popup h2 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            font-weight: 600;
            color: #fff;
        }
        #telegram-popup p {
            margin-bottom: 1.5rem;
            line-height: 1.6; /* Improved line height for readability */
            color: #eee;
        }
        #telegram-popup .join-button {
            display: inline-block;
            background-color: #29b6f6; /* Telegram blue */
            color: #fff;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            text-decoration: none;
            font-weight: 600;
            transition: background-color 0.2s ease-in-out, transform 0.1s ease;
            font-size: 1.1rem;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }
        #telegram-popup .join-button:hover {
            background-color: #0288d1; /* Darker blue */
            transform: translateY(-2px);
            box-shadow: 0 3px 7px rgba(0, 0, 0, 0.4);
        }
        #telegram-popup .close-button {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            font-size: 2rem;
            color: #fff;
            cursor: pointer;
            opacity: 0.7;
            transition: opacity 0.2s ease;
            padding: 0.25rem; /* Add padding to the close button */
            line-height: 1; /* Adjust line height to vertically center the X */
        }
        #telegram-popup .close-button:hover {
            opacity: 1;
        }
        #telegram-popup .close-button:active {
             transform: translateY(0);
        }

    </style>
</head>
<body>
    <div class="container">
        <h1>Enhanced HLS Player</h1>
        <video id="video" controls playsinline></video>
        <div class="input-container">
            <label for="hls-url">HLS URL:</label>
            <input type="text" id="hls-url" placeholder="Enter HLS URL (e.g., https://yourdomain.com/yourstream.m3u8)">
        </div>
        <button id="load-button">Load Stream</button>
        <div id="error-message"></div>
        <div class="loading" id="loading-indicator">Loading...</div>

        <div id="telegram-popup">
            <span class="close-button">&times;</span>
            <h2>Join Our Telegram Channel</h2>
            <p>Stay updated with the latest news, updates, and exclusive content by joining our Telegram channel:</p>
            <a href="https://t.me/yourchannelname" target="_blank" rel="noopener noreferrer" class="join-button">Join Now</a>
        </div>

    </div>

    <script>
        const video = document.getElementById('video');
        const hlsUrlInput = document.getElementById('hls-url');
        const loadButton = document.getElementById('load-button');
        const errorMessage = document.getElementById('error-message');
        const loadingIndicator = document.getElementById('loading-indicator');
        const telegramPopup = document.getElementById('telegram-popup');
        const telegramCloseButton = telegramPopup.querySelector('.close-button');

        function showError(message) {
            errorMessage.textContent = message;
            errorMessage.style.display = 'block';
            loadingIndicator.classList.remove('show');
        }

        function clearError() {
            errorMessage.style.display = 'none';
            errorMessage.textContent = '';
        }

        function showTelegramPopup() {
            if (sessionStorage.getItem('telegramShown')) return;  // Don't show if already shown this session
            telegramPopup.classList.add('show');
            sessionStorage.setItem('telegramShown', 'true'); //set the session storage
        }

        function hideTelegramPopup() {
            telegramPopup.classList.remove('show');
        }

        loadButton.addEventListener('click', function() {
            const hlsUrl = hlsUrlInput.value.trim();
            clearError();

            if (!hlsUrl) {
                showError('Please enter an HLS URL.');
                return;
            }

            if (!hlsUrl.startsWith('http://') && !hlsUrl.startsWith('https://')) {
                showError('Invalid URL.  Must start with http:// or https://');
                return;
            }

            loadingIndicator.classList.add('show');

            if (Hls.isSupported()) {
                if (video.src !== hlsUrl) {
                    video.src = hlsUrl;
                }
                const hls = new Hls();
                hls.loadSource(hlsUrl);
                hls.attachMedia(video);
                hls.on(Hls.Events.MANIFEST_PARSED, function() {
                    video.play();
                    loadingIndicator.classList.remove('show');
                });

                hls.on(Hls.Events.ERROR, function(event, data) {
                    if (data.fatal) {
                        console.error('HLS error:', event, data);
                        switch (data.type) {
                            case Hls.ErrorTypes.NETWORK_ERROR:
                                console.log('network error, try to recover');
                                hls.startLoad();
                                break;
                            case Hls.ErrorTypes.MEDIA_ERROR:
                                console.log('media error, try to recover');
                                hls.recoverMediaError();
                                break;
                            default:
                                showError('Fatal HLS error: ' + data.type);
                                loadingIndicator.classList.remove('show');
                                break;
                        }
                    }
                });
            } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
                video.src = hlsUrl;
                video.addEventListener('loadedmetadata', function() {
                    video.play();
                    loadingIndicator.classList.remove('show');
                });
                video.addEventListener('error', function(e) {
                    console.error("Native HLS error", e);
                    showError('Error loading stream using native HLS.');
                    loadingIndicator.classList.remove('show');
                });
            } else {
                showError('HLS is not supported in this browser.');
                loadingIndicator.classList.remove('show');
            }
        });

        telegramCloseButton.addEventListener('click', hideTelegramPopup);

        // Show the popup after a delay, e.g., 3 seconds
        setTimeout(showTelegramPopup, 3000);
    </script>
</body>
    </html>
    
